## Домашнее задание № 5
### Название урока: Нагрузочное тестирование и тюнинг PostgreSQL

Цель:
- сделать нагрузочное тестирование PostgreSQL
- настроить параметры PostgreSQL для достижения максимальной производительности

### Описание/Пошаговая инструкция выполнения домашнего задания:
- развернуть виртуальную машину любым удобным способом
- поставить на неё PostgreSQL 15 любым способом
- настроить кластер PostgreSQL 15 на максимальную производительность не обращая внимание на возможные проблемы с надежностью в случае аварийной перезагрузки виртуальной машины
- нагрузить кластер через утилиту через утилиту pgbench (https://postgrespro.ru/docs/postgrespro/14/pgbench)
- написать какого значения tps удалось достичь, показать какие параметры в какие значения устанавливали и почему
Задание со *: аналогично протестировать через утилиту https://github.com/Percona-Lab/sysbench-tpcc (требует установки
https://github.com/akopytov/sysbench)

### Выполнение домашнего задания
- ВМ уже была развернула с прошлых домашних заданий (Rocky Linux 9.6)
- PostgreSQL 18 уже стоял на хосте (не Docker)
- Сначала был выполнен тест без настроек вообще, его результаты:
```Создание БД для pgbench```   
![Создание БД под тест](screens/createdbtest.png)

```Создание таблиц в БД```
![Создание таблиц в БД](screens/createtables.png)

```Просмотр созданных таблиц```
![Просмотр таблиц](screens/showtables.png)

```Тестирование без каких-либо настроек```
![Тестирование без настроек](screens/test1withouttuning.png)

```Настройки под мою ВМ (первый тюнинг)```
![Первый тюнинг](screens/first_tuning.png)

```Результаты после теста первого тюнинга```
![Результат после первого тюнинга](screens/testafterfirsttuning.png)

```Чтобы ускорить результаты тестирования ввел дополнительные настройки, которые позволяют не ждать записи на диск, отключают fsync, отключают full page writes после чекпоинта```
![Настройки второго тюнинга](screens/second_tuning.png)

```Результаты второго тюнинга```
![Результаты после второго тюнинга](screens/testaftersecondtuning.png)

Как видно из результатов второго тюнинга, результаты изменились в сторону быстродействия.

- Теперь задание со зведкочкой
```Устанавливаем репозиторий для sysbench```
![Установка репозитория для sysbench](screens/addreposysbench.png)

```Установка sysbench```
![Установка sysbench](screens/installsysbenchdnf.png)

```Создаем БД под тест TPCC```
![Создание БД под тест TPCC](screens/createsbdb.png)

```TPCC подготовка```
![TPCC prepare](screens/tpcc_prepare.png)

```TPCC запуск```
![TPCC run](screens/tpcc_run.png)

```TPCC результаты```
![TPCC результаты](screens/tpcc_results.png)

По результатам видно что для этой ВМ, результат хороший. 269 транзакций в секунду.

```Очистка тестовой таблицы```
![Очистка тестовой таблицы](screens/tpcc_cleanup.png)